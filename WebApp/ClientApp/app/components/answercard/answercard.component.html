<p *ngIf="!answerView"><em>Loading...</em></p>
<div *ngIf="answerView" class="answer-card">
    <div *ngIf="!isUpdateAnswerVisible">
        <div class="answer-user" *ngIf="answerView.answer.user">
            {{answerView.answer.user.name}}
            <span *ngIf="!answerView.averageRating"
                  class="no-rating">
                No ratings yet
            </span>
            <span *ngIf="answerView.averageRating"
                  class="average-rating">
                {{answerView.averageRating}} / 5
            </span>

            <div class="answer-date">
                Answered {{answerView.answer.originDate | readableDate}}
                <span *ngIf="answerView.answer.price > 0 && !isAuthor"
                      class="buy-offer">
                    <span class="price-tag">${{answerView.answer.price}}</span>
                    <!--Buy-->
                    <button class="btn btn-success btn-sm ml-3"
                            (click)="OnPurchaseClick()">
                        <i class="fas fa-shopping-cart"></i>
                        Buy
                    </button>

                    <!--counter offer-->
                    <button class="btn btn-secondary btn-sm ml-2"
                            (click)="OnCounterOfferClick()">
                        <i class="fas fa-hand-holding-usd"></i>
                        Counter offer
                    </button>

                    <card-pay *ngIf="false"></card-pay>

                </span>
            </div>
        </div>

        <!--Rating-->
        <div *ngIf="!isAuthor">
            <div class="rating" *ngIf="rating[0]">
                <span (click)="rate(5)">☆</span>
                <span (click)="rate(4)">☆</span>
                <span (click)="rate(3)">☆</span>
                <span (click)="rate(2)">☆</span>
                <span (click)="rate(1)">☆</span>
            </div>
            <div class="rating" *ngIf="rating[1]">
                <span (click)="rate(5)">☆</span>
                <span (click)="rate(4)">☆</span>
                <span (click)="rate(3)">☆</span>
                <span (click)="rate(2)">☆</span>
                <span (click)="rate(1)">★</span>
            </div>
            <div class="rating" *ngIf="rating[2]">
                <span (click)="rate(5)">☆</span>
                <span (click)="rate(4)">☆</span>
                <span (click)="rate(3)">☆</span>
                <span (click)="rate(2)">★</span>
                <span (click)="rate(1)">★</span>
            </div>
            <div class="rating" *ngIf="rating[3]">
                <span (click)="rate(5)">☆</span>
                <span (click)="rate(4)">☆</span>
                <span (click)="rate(3)">★</span>
                <span (click)="rate(2)">★</span>
                <span (click)="rate(1)">★</span>
            </div>
            <div class="rating" *ngIf="rating[4]">
                <span (click)="rate(5)">☆</span>
                <span (click)="rate(4)">★</span>
                <span (click)="rate(3)">★</span>
                <span (click)="rate(2)">★</span>
                <span (click)="rate(1)">★</span>
            </div>
            <div class="rating" *ngIf="rating[5]">
                <span (click)="rate(5)">★</span>
                <span (click)="rate(4)">★</span>
                <span (click)="rate(3)">★</span>
                <span (click)="rate(2)">★</span>
                <span (click)="rate(1)">★</span>
            </div>
        </div>

        <!--Answer Content-->
        <div class="my-4">
            <html-content [htmlString]="answerView.answer.redactedHtmlContent"
                          class="answer-content">
            </html-content>
        </div>

        <div *ngIf="isAuthor">
            <!--Edit-->
            <button class="btn btn-sm"
                    (click)="OnEditClick()">
                Edit
            </button>

            <!--Delete-->
            <button class="btn btn-sm ml-1"
                    (click)="OnDeleteClick()">
                <span *ngIf="answerView.answer.isDeleted">Undelete</span>
                <span *ngIf="!answerView.answer.isDeleted">Delete</span>
            </button>
        </div>

    </div>

    <!--Answer editor-->
    <div *ngIf="isUpdateAnswerVisible">
        <answer-editor-inline [answerId]="answerView.answer.id"
                              (answerUpdated)="onAnswerUpdated($event)"
                              (updateCancelled)="onUpdateCancelled()">
        </answer-editor-inline>
    </div>
</div>
